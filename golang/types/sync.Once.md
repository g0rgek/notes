Несколько потоков могут выполнить `once.Do(f)` для конкретного `f`, но только один выполнит `f()`, а остальные вызовы блокируются до завершения `f()`.

`sync.Once` использует атомарный флаг `done` и мьютекс, так что любая горутина, запущенная первой, выполняет предоставленную функцию и все остальные горутины, вызывающие `Do` в том же блоке/возврате `Once`.

Завершение одного вызова `f()` из `once.Do(f)` синхронизируется до завершения любого вызова `once.Do(f)`.

Вызов `twoprint` вызовет `setup` ровно один раз. Функция `setup` завершится до любого вызова `print`. Результатом будет то, что `"hello, world"` будет напечатано дважды.

```go
var a string
var once sync.Once

func setup() {
	a = "hello, world"
}

func doprint() {
	once.Do(setup)
	print(a)
}

func twoprint() {
	go doprint()
	go doprint()
}
```